<IfModule mod_ssl.c>
<VirtualHost *:443>
    ServerName projectdelta.local
    ServerAlias www.projectdelta.local localhost
    DocumentRoot /var/www/html
    DirectoryIndex index.php index.html

    # SSL Configuration
    SSLEngine on
    SSLCertificateFile /etc/ssl/projectdelta/projectdelta.crt
    SSLCertificateKeyFile /etc/ssl/projectdelta/projectdelta.key
    
    # SSL Security Settings
    SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1
    SSLCipherSuite ECDHE+AESGCM:ECDHE+AES256:ECDHE+AES128:!aNULL:!MD5:!DSS
    SSLHonorCipherOrder on
    
    # Enhanced Security Headers for HTTPS
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    Header always set Permissions-Policy "geolocation=(), microphone=(), camera=()"
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
    
    # Document root directory security
    <Directory "/var/www/html">
        Options -Indexes -FollowSymLinks
        AllowOverride None
        Require all granted
        
        # Block access to sensitive files
        <FilesMatch "\.(env|git|htaccess|htpasswd|ini|log|sh|sql)$">
            Require all denied
        </FilesMatch>
        
        # Disable dangerous HTTP methods within directory
        <LimitExcept GET POST HEAD>
            Require all denied
        </LimitExcept>
    </Directory>
    
    # Prevent access to .git and .env directories
    <DirectoryMatch "^\.|\/\.">
        Require all denied
    </DirectoryMatch>
    
    ErrorLog ${APACHE_LOG_DIR}/ssl_error.log
    CustomLog ${APACHE_LOG_DIR}/ssl_access.log combined
</VirtualHost>
</IfModule>
